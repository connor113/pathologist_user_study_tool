# tasks/T-0011.md — Offline Analysis Tools (≤4 hours)

**Goal:** Create Jupyter notebooks and Python scripts for CSV-based analysis: summary statistics, temporal patterns, pathologist comparisons, and heatmap generation.

**AC:**
- Jupyter notebook `analysis/notebooks/01_event_analysis.ipynb` with sections:
  - Load CSV exports (single file or directory of CSVs)
  - Summary statistics per session: duration, total events, clicks by zoom level, unique cells visited
  - Temporal analysis: time spent at each zoom level, transitions between levels
  - Viewport coverage: % of slide viewed at each magnification
  - Comparison across pathologists: average session duration, click patterns, zoom preferences
  - Export summary table as CSV

- Python script `analysis/scripts/generate_heatmap.py`:
  - Usage: `python generate_heatmap.py --csv events.csv --slide slide_id --output heatmap.png`
  - Load slide thumbnail (use DZI level 14 or 15 for 2.5×/5× view)
  - Overlay semi-transparent heatmap showing clicked cells (frequency-based coloring)
  - Draw viewport rectangles for all events (faint gray)
  - Highlight clicked cells (red intensity based on visit count)
  - Add legend, scale bar, timestamp range
  - Save as high-res PNG (300 DPI for publication)

- Python script `analysis/scripts/visualize_scanning_path.py`:
  - Usage: `python visualize_scanning_path.py --csv events.csv --slide slide_id --output path.png` (or .gif for animation)
  - Static version: lines connecting clicks overlaid on thumbnail, color gradient for time
  - Animated version (optional): GIF showing viewport moving across slide with progressive line drawing
  - Annotate zoom transitions with markers
  - Include timestamp and zoom level text

**Constraints:**
- Dependencies: pandas, matplotlib, seaborn, pillow, numpy (documented in `analysis/requirements.txt`)
- Scripts accept CSV path, slide_id, output path as arguments
- Thumbnails loaded from local DZI tiles (scripts assume tiles available locally)
- Notebooks include markdown explanations for reproducibility
- Example outputs included in `analysis/examples/` directory

**Test notes:**
- Run notebook on 700+ event CSV
- Generate heatmap for test_slide
- Verify heatmap overlay aligns with slide tissue regions
- Compare statistics across multiple sessions (if available)
- Test animated GIF generation (optional feature)

**Deliverables:**
- `analysis/notebooks/01_event_analysis.ipynb` - Interactive analysis notebook
- `analysis/scripts/generate_heatmap.py` - Heatmap generation script
- `analysis/scripts/visualize_scanning_path.py` - Scanning path visualization
- `analysis/requirements.txt` - Python dependencies for analysis
- `analysis/README.md` - Usage documentation and examples
- `analysis/examples/` - Example outputs (heatmap, path visualization)

