# tasks/T-0007.md — Cloud Deployment (≤4 hours)

**Goal:** Deploy backend to Railway or Render with managed PostgreSQL; deploy frontend to Vercel; upload all slide tiles to S3 with CloudFront CDN; configure environment variables and test production URLs.

**AC:**
- AWS S3 bucket created with public read access (or signed URLs); all tiles uploaded from `tiles/` directory
- S3 bucket structure: `slides/{slide_id}/files/{level}/{x}_{y}.jpeg`
- CloudFront distribution created pointing to S3 bucket; caching configured with 24hr TTL
- Slide manifests inserted into database (not stored in S3); reference S3 key prefix
- Backend deployed to Railway or Render with PostgreSQL addon; database migrations run successfully
- Environment variables configured in Railway/Render: DATABASE_URL, JWT_SECRET, AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY, S3_BUCKET_NAME, CLOUDFRONT_URL, FRONTEND_URL (for CORS)
- Frontend deployed to Vercel; environment variable configured: VITE_API_URL (points to Railway/Render backend URL)
- Production frontend loads login page; can complete full pathologist workflow (login → view slide → interact → label → next slide)
- Tiles load from CloudFront within 500ms (test with browser network tab)
- Backend logs accessible via Railway/Render dashboard for debugging

**Constraints:**
- S3 bucket in us-east-1 or closest region to users
- CloudFront distribution with HTTPS only
- Railway or Render: choose based on pricing and ease of PostgreSQL setup (evaluate both if time permits)
- Vercel deployment: connect to GitHub repo; auto-deploy on push to main branch
- Use Railway/Render free tier or lowest paid tier ($5-10/mo)
- No AWS Lambda or other serverless backend (keep it simple)

**Test notes:**
- Upload 1 test slide to S3 first; verify tiles accessible via CloudFront URL
- Test backend health endpoint: `GET https://backend.railway.app/health` returns 200 OK
- Test frontend production URL: load in incognito browser, login, complete 1 slide
- Monitor CloudFront cache hit rate (should be >90% after initial tile loads)
- Test CORS: ensure frontend can call backend APIs (check browser console for CORS errors)
- Verify HTTPS on both frontend and backend (no mixed content warnings)

**Deliverables:**
- `scripts/upload-tiles-to-s3.js` - Node.js script to bulk upload tiles from `tiles/` to S3
- `scripts/seed-database.js` - Script to insert slide metadata into database after S3 upload
- `backend/.env.example` - Updated with all required environment variables
- `vercel.json` - Vercel deployment config (if needed for routing or env vars)
- `railway.toml` or `render.yaml` - Backend deployment config (if needed)
- Documentation: `DEPLOYMENT.md` with step-by-step deployment instructions
- AWS S3 bucket created and configured
- CloudFront distribution created and DNS configured
- Railway/Render project created with PostgreSQL
- Vercel project created and connected to GitHub
- All environment variables configured in hosting platforms


