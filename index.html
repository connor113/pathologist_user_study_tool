<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WSI Viewer - Pathologist Study</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }
    #viewer {
      width: calc(100vw - 320px);
      height: 100vh;
      background: #000;
    }
    /* Right sidebar - fixed, doesn't overlap image */
    #right-sidebar {
      position: fixed;
      right: 0;
      top: 0;
      width: 320px;
      height: 100vh;
      background: rgba(255, 255, 255, 0.98);
      box-shadow: -2px 0 12px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      overflow-y: auto;
      padding: 20px;
      box-sizing: border-box;
    }
    
    #right-sidebar h3 {
      margin: 0 0 15px 0;
      font-size: 18px;
      font-weight: bold;
      color: #333;
      border-bottom: 2px solid #ddd;
      padding-bottom: 10px;
    }
    
    #right-sidebar section {
      margin-bottom: 30px;
    }
    
    /* Arrow buttons at screen edges */
    .arrow-btn {
      position: absolute;
      width: 50px;
      height: 50px;
      font-size: 24px;
      cursor: pointer;
      border: 2px solid rgba(255, 255, 255, 0.8);
      background: rgba(0, 0, 0, 0.5);
      color: white;
      border-radius: 8px;
      z-index: 900;
      transition: all 0.2s ease;
    }
    
    .arrow-btn:hover:not(:disabled) {
      background: rgba(0, 0, 0, 0.7);
      border-color: rgba(255, 255, 255, 1);
      transform: scale(1.1);
    }
    
    .arrow-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
      background: rgba(100, 100, 100, 0.3);
    }
    
    /* Position each arrow at screen edges */
    /* Up/down arrows centered on viewer (not screen) */
    /* Viewer is calc(100vw - 320px), so center is at (100vw - 320px) / 2 */
    #btn-up {
      top: 20px;
      left: calc((100vw - 320px) / 2);
      transform: translateX(-50%);
    }
    
    #btn-down {
      bottom: 20px;
      left: calc((100vw - 320px) / 2);
      transform: translateX(-50%);
    }
    
    #btn-left {
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
    }
    
    #btn-right {
      right: 340px; /* Position before sidebar (320px + 20px margin) */
      top: 50%;
      transform: translateY(-50%);
    }
    
    #btn-up:hover:not(:disabled),
    #btn-down:hover:not(:disabled) {
      transform: translateX(-50%) scale(1.1);
    }
    
    #btn-left:hover:not(:disabled),
    #btn-right:hover:not(:disabled) {
      transform: translateY(-50%) scale(1.1);
    }
    /* Label selection */
    .label-option {
      display: block;
      margin: 10px 0;
      cursor: pointer;
      user-select: none;
    }
    
    .label-option input[type="radio"] {
      margin-right: 8px;
      cursor: pointer;
    }
    
    .label-option label {
      cursor: pointer;
      font-size: 14px;
      color: #333;
    }
    
    /* Notes textarea */
    #notes-textarea {
      width: 100%;
      min-height: 80px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-family: Arial, sans-serif;
      font-size: 14px;
      resize: vertical;
      box-sizing: border-box;
    }
    
    #notes-textarea:focus {
      outline: none;
      border-color: #007bff;
    }
    
    /* Debug info */
    #debug-info {
      font-size: 12px;
      font-family: monospace;
      color: #555;
      line-height: 1.8;
    }
    
    #debug-info div {
      margin: 5px 0;
    }
    
    #debug-info strong {
      color: #000;
    }
    
    /* Sidebar buttons */
    .sidebar-btn {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      border: none;
      border-radius: 6px;
      transition: all 0.2s ease;
    }
    
    .sidebar-btn:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    }
    
    .sidebar-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }
    
    #btn-confirm {
      background: #28a745;
      color: white;
    }
    
    #btn-confirm:hover {
      background: #218838;
    }
    
    #btn-back {
      background: #6c757d;
      color: white;
    }
    
    #btn-back:hover:not(:disabled) {
      background: #5a6268;
    }
    
    #btn-reset {
      background: #ffc107;
      color: #333;
    }
    
    #btn-reset:hover {
      background: #e0a800;
    }
    
    #btn-export {
      background: #007bff;
      color: white;
    }
    
    #btn-export:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <div id="viewer"></div>
  
  <!-- Arrow buttons at screen edges -->
  <button id="btn-up" class="arrow-btn" disabled title="Pan Up (W / ‚Üë)">‚Üë</button>
  <button id="btn-down" class="arrow-btn" disabled title="Pan Down (S / ‚Üì)">‚Üì</button>
  <button id="btn-left" class="arrow-btn" disabled title="Pan Left (A / ‚Üê)">‚Üê</button>
  <button id="btn-right" class="arrow-btn" disabled title="Pan Right (D / ‚Üí)">‚Üí</button>
  
  <!-- Right sidebar with all controls -->
  <div id="right-sidebar">
    <!-- Diagnosis section -->
    <section>
      <h3>Diagnosis</h3>
      <div class="label-option">
        <input type="radio" id="label-normal" name="diagnosis" value="normal">
        <label for="label-normal">Normal</label>
      </div>
      <div class="label-option">
        <input type="radio" id="label-benign" name="diagnosis" value="benign">
        <label for="label-benign">Benign lesion</label>
      </div>
      <div class="label-option">
        <input type="radio" id="label-malignant" name="diagnosis" value="malignant">
        <label for="label-malignant">Malignant</label>
      </div>
      <button id="btn-confirm" class="sidebar-btn">Confirm & Next</button>
    </section>
    
    <!-- Notes section -->
    <section>
      <h3>Notes</h3>
      <textarea id="notes-textarea" placeholder="Add optional notes here..."></textarea>
    </section>
    
    <!-- Controls section -->
    <section>
      <h3>Controls</h3>
      <button id="btn-back" class="sidebar-btn" disabled>‚Üê Back</button>
      <button id="btn-reset" class="sidebar-btn">‚Ü∫ Reset</button>
      <button id="btn-export" class="sidebar-btn">üíæ Export CSV</button>
    </section>
    
    <!-- Debug info section -->
    <section>
      <h3>Info</h3>
      <div id="debug-info">
        <div><strong>Zoom:</strong> <span id="current-zoom">Loading...</span></div>
        <div><strong>Fits at 5√ó:</strong> <span id="fit-status">?</span></div>
        <div><strong>Start level:</strong> <span id="start-level">?</span></div>
        <div><strong>Grid:</strong> <span id="grid-dims">?</span></div>
      </div>
    </section>
  </div>
  
  <script type="module" src="/src/viewer/main.ts"></script>
</body>
</html>

